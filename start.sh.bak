#!/bin/bash
set -e

echo "Starter GraphQL..."
podman rm -f graphql nginx 2>/dev/null || true

podman network inspect webnet >/dev/null 2>&1 || podman network create webnet

podman run -d --restart=always --name graphql \
  --network webnet \
  -v /home/kaiking/projects/myapp:/work \
  -w /work \
  mcr.microsoft.com/dotnet/sdk:8.0 \
  bash -lc 'dotnet run --no-launch-profile --urls "http://0.0.0.0:8081"'

echo "Starter Nginx..."
podman run -d --restart=always --name nginx \
  --network webnet \
  -p 0.0.0.0:80:80 \
  -v /home/kaiking/nginx/default.conf:/etc/nginx/conf.d/default.conf:ro \
  docker.io/library/nginx:alpine

echo "Alt startet"

